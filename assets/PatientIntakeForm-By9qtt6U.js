import{d as e,y as l,q as t,u as i}from"./vendor-CGONjlB7.js";import{t as a,d as r}from"./services-B2mp8VjL.js";import{u as n,c as s,C as c,d as o,B as d}from"./ui-BdrEFVfQ.js";import"./database-DJZASbgB.js";const m={ageGroup:"",pulse:"",breathing:"",circulation:"",consciousness:"",respiratoryRate:"",capillaryRefill:"",radialPulse:"",mobility:"",injuries:"",notes:""};function u({onSubmit:u,onCancel:p,existingPatient:h,isEditing:x=!1}){const{t:b}=n(),[v,g]=e(m),[y,f]=e({}),[k,R]=e(!1),[w,C]=e(null),[z,j]=e(!1);l(()=>{h&&g({ageGroup:h.ageGroup,pulse:h.vitals.pulse?.toString()||"",breathing:h.vitals.breathing,circulation:h.vitals.circulation,consciousness:h.vitals.consciousness,respiratoryRate:h.vitals.respiratoryRate?.toString()||"",capillaryRefill:h.vitals.capillaryRefill?.toString()||"",radialPulse:h.vitals.radialPulse||"",mobility:h.mobility||"",injuries:h.injuries.join(", "),notes:h.notes||""})},[h]);const P=t(()=>Object.keys(v).some(e=>v[e]!==m[e])&&!k,[v,k]);s(P(),"intake");const G=t(()=>Boolean(v.ageGroup&&v.breathing&&v.circulation&&v.consciousness&&v.mobility),[v]),B=t(()=>({id:"temp-id",ageGroup:v.ageGroup,vitals:{pulse:v.pulse?parseInt(v.pulse):null,breathing:v.breathing,circulation:v.circulation,consciousness:v.consciousness,respiratoryRate:v.respiratoryRate?parseInt(v.respiratoryRate):null,capillaryRefill:v.capillaryRefill?parseFloat(v.capillaryRefill):null,radialPulse:v.radialPulse},mobility:v.mobility,injuries:v.injuries?v.injuries.split(",").map(e=>e.trim()).filter(e=>e):[],notes:v.notes||void 0,timestamp:new Date,lastUpdated:new Date,priority:{level:"green",description:"",urgency:3,color:"",icon:""},status:"active"}),[v]);l(()=>{(()=>{if(G())try{const e=B(),l=a.assessPatient(e);C(l.priority),j(!0)}catch{C(null),j(!1)}else j(!1)})()},[v,G,B]);const M=(e,l)=>{g(t=>({...t,[e]:l})),y[e]&&f(l=>({...l,[e]:void 0}))},N=()=>{const e=["ageGroup","breathing","circulation","consciousness","mobility"],l=e.filter(e=>{const l=v[e];return l&&""!==l});return Math.round(l.length/e.length*100)};return i("div",{class:"max-w-4xl mx-auto space-y-6",children:[i(c,{variant:"default",padding:"md",children:i("div",{class:"text-center sm:text-left",children:[i("h2",{class:"text-responsive-xl font-bold text-medical-text-primary mb-2",children:b(x?"patient.edit.title":"patient.intake.title")}),i("p",{class:"text-medical-text-secondary text-responsive-sm mb-4",children:b("assessment.start.sub")}),i("div",{class:"mt-4",children:[i("div",{class:"flex items-center justify-between mb-2",children:[i("span",{class:"text-sm font-medium text-medical-text-primary",children:b("intake.progress")}),i("span",{class:"text-sm text-medical-text-secondary",children:[N(),"% ",b("common.complete")]})]}),i("div",{class:"w-full bg-gray-200 rounded-full h-2",children:i("div",{class:"bg-medical-primary h-2 rounded-full transition-all duration-300",style:{width:`${N()}%`}})})]})]})}),z&&w&&i("div",{className:"animate-slide-up medical-card border-2 border-dashed",style:{borderColor:w.color,backgroundColor:`${w.color}08`},children:i("div",{class:"flex items-center gap-3",children:[i("div",{class:"w-5 h-5 rounded-full flex-shrink-0",style:{backgroundColor:w.color}}),i("div",{class:"flex-1",children:[i("h3",{class:"font-semibold text-medical-text-primary text-responsive-sm",children:"Predicted Triage Priority"}),i("p",{class:"text-sm font-medium",style:{color:w.color},children:w.description})]}),i("div",{class:"text-xs bg-white bg-opacity-50 px-2 py-1 rounded-md",children:"Preview"})]})}),i("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};if(v.ageGroup||(e.ageGroup=b("validation.required")),v.breathing||(e.breathing=b("validation.required")),v.circulation||(e.circulation=b("validation.required")),v.consciousness||(e.consciousness=b("validation.required")),v.mobility||(e.mobility=b("validation.required")),v.pulse){const l=parseInt(v.pulse);(isNaN(l)||l<20||l>250)&&(e.pulse=b("validation.invalidPulse"))}if(v.respiratoryRate){const l=parseInt(v.respiratoryRate);(isNaN(l)||l<5||l>60)&&(e.respiratoryRate=b("validation.invalidRespiratory"))}if(v.capillaryRefill){const l=parseFloat(v.capillaryRefill);(isNaN(l)||l<0||l>10)&&(e.capillaryRefill=b("validation.invalidCapillary"))}return f(e),0===Object.keys(e).length})()){R(!0),f({});try{const e={ageGroup:v.ageGroup,vitals:{pulse:v.pulse?parseInt(v.pulse):null,breathing:v.breathing,circulation:v.circulation,consciousness:v.consciousness,respiratoryRate:v.respiratoryRate?parseInt(v.respiratoryRate):null,capillaryRefill:v.capillaryRefill?parseFloat(v.capillaryRefill):null,radialPulse:v.radialPulse},mobility:v.mobility,injuries:v.injuries?v.injuries.split(",").map(e=>e.trim()).filter(e=>e):[],notes:v.notes||void 0},l=await r.createPatient(e);g(m),C(null),j(!1),u&&u(l)}catch(l){f({general:b("toast.errorOccurred")})}finally{R(!1)}}},class:"space-y-6",children:[y.general&&i(c,{variant:"outlined",padding:"sm",className:"border-medical-error bg-red-50",children:i("div",{class:"flex items-center gap-2",children:[i("svg",{class:"w-5 h-5 text-medical-error flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:i("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),i("p",{class:"text-medical-error text-sm font-medium",children:y.general})]})}),i(c,{variant:"default",padding:"md",children:[i("h3",{class:"text-responsive-lg font-semibold text-medical-text-primary mb-4 flex items-center gap-2",children:[i("div",{class:"w-6 h-6 bg-medical-primary text-white rounded-full flex items-center justify-center text-sm font-bold",children:"1"}),b("intake.basicInfo")]}),i("div",{children:[i("label",{class:"block text-sm font-medium text-medical-text-primary mb-3",children:[b("intake.ageGroup")," ",i("span",{class:"text-medical-error",children:"*"})]}),i(o,{cols:{xs:2},gap:"sm",children:[i("button",{type:"button",onClick:()=>M("ageGroup","child"),class:`\n                  touch-target p-4 border-2 rounded-xl text-center transition-all duration-200 font-medium\n                  ${"child"===v.ageGroup?"border-medical-primary bg-blue-50 text-medical-primary shadow-sm":"border-gray-300 hover:border-gray-400 hover:bg-gray-50 active:bg-gray-100"}\n                `,children:[i("div",{class:"text-2xl mb-1",children:"👶"}),b("intake.ageGroup.child")]}),i("button",{type:"button",onClick:()=>M("ageGroup","adult"),class:`\n                  touch-target p-4 border-2 rounded-xl text-center transition-all duration-200 font-medium\n                  ${"adult"===v.ageGroup?"border-medical-primary bg-blue-50 text-medical-primary shadow-sm":"border-gray-300 hover:border-gray-400 hover:bg-gray-50 active:bg-gray-100"}\n                `,children:[i("div",{class:"text-2xl mb-1",children:"👤"}),b("intake.ageGroup.adult")]})]}),y.ageGroup&&i("p",{class:"text-medical-error text-sm mt-2 flex items-center gap-1",children:[i("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:i("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),y.ageGroup]})]})]}),i(c,{variant:"default",padding:"md",children:[i("h3",{class:"text-responsive-lg font-semibold text-medical-text-primary mb-4 flex items-center gap-2",children:[i("div",{class:"w-6 h-6 bg-medical-accent text-white rounded-full flex items-center justify-center text-sm font-bold",children:"2"}),b("intake.vitals")]}),i(o,{cols:{xs:1,md:2},gap:"md",children:[i("div",{children:[i("label",{class:"block text-sm font-medium text-medical-text-primary mb-2",children:b("intake.pulse")}),i("input",{type:"number",value:v.pulse,onChange:e=>M("pulse",e.currentTarget.value),placeholder:b("intake.pulsePlaceholder"),min:"20",max:"250",class:"form-input"}),y.pulse&&i("p",{class:"text-medical-error text-sm mt-1 flex items-center gap-1",children:[i("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:i("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),y.pulse]})]}),i("div",{children:[i("label",{class:"block text-sm font-medium text-medical-text-primary mb-2",children:b("intake.respiratoryRate")}),i("input",{type:"number",value:v.respiratoryRate,onChange:e=>M("respiratoryRate",e.currentTarget.value),placeholder:b("intake.respiratoryPlaceholder"),min:"5",max:"60",class:"form-input"}),y.respiratoryRate&&i("p",{class:"text-medical-error text-sm mt-1 flex items-center gap-1",children:[i("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:i("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),y.respiratoryRate]})]})]})]}),i(c,{variant:"default",padding:"md",children:[i("h3",{class:"text-responsive-lg font-semibold text-medical-text-primary mb-4 flex items-center gap-2",children:[i("div",{class:"w-6 h-6 bg-medical-success text-white rounded-full flex items-center justify-center text-sm font-bold",children:"3"}),b("intake.clinicalAssessment")]}),i("div",{class:"space-y-6",children:[i("div",{children:[i("label",{class:"block text-sm font-medium text-medical-text-primary mb-2",children:[b("intake.breathing")," ",i("span",{class:"text-medical-error",children:"*"})]}),i("select",{value:v.breathing,onChange:e=>M("breathing",e.currentTarget.value),class:"form-select",children:[i("option",{value:"",children:b("validation.selectOption")}),i("option",{value:"normal",children:["🫁 ",b("intake.breathing.normal")]}),i("option",{value:"labored",children:["😤 ",b("intake.breathing.labored")]}),i("option",{value:"absent",children:["❌ ",b("intake.breathing.absent")]})]}),y.breathing&&i("p",{class:"text-medical-error text-sm mt-1 flex items-center gap-1",children:[i("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:i("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),y.breathing]})]}),i("div",{children:[i("label",{class:"block text-sm font-medium text-medical-text-primary mb-2",children:[b("intake.circulation")," ",i("span",{class:"text-medical-error",children:"*"})]}),i("select",{value:v.circulation,onChange:e=>M("circulation",e.currentTarget.value),class:"form-select",children:[i("option",{value:"",children:b("validation.selectOption")}),i("option",{value:"normal",children:["💓 ",b("intake.circulation.normal")]}),i("option",{value:"bleeding",children:["🩸 ",b("intake.circulation.bleeding")]}),i("option",{value:"shock",children:["⚠️ ",b("intake.circulation.shock")]})]}),y.circulation&&i("p",{class:"text-medical-error text-sm mt-1 flex items-center gap-1",children:[i("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:i("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),y.circulation]})]}),i("div",{children:[i("label",{class:"block text-sm font-medium text-medical-text-primary mb-2",children:[b("intake.consciousness")," ",i("span",{class:"text-medical-error",children:"*"})]}),i("select",{value:v.consciousness,onChange:e=>M("consciousness",e.currentTarget.value),class:"form-select",children:[i("option",{value:"",children:b("validation.selectOption")}),i("option",{value:"alert",children:["😊 ",b("intake.consciousness.alert")]}),i("option",{value:"verbal",children:["🗣️ ",b("intake.consciousness.verbal")]}),i("option",{value:"pain",children:["😣 ",b("intake.consciousness.pain")]}),i("option",{value:"unresponsive",children:["😵 ",b("intake.consciousness.unresponsive")]})]}),y.consciousness&&i("p",{class:"text-medical-error text-sm mt-1 flex items-center gap-1",children:[i("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:i("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),y.consciousness]})]}),i("div",{children:[i("label",{class:"block text-sm font-medium text-medical-text-primary mb-3",children:[b("intake.mobility")," ",i("span",{class:"text-medical-error",children:"*"})]}),i(o,{cols:{xs:2},gap:"sm",children:[i("button",{type:"button",onClick:()=>M("mobility","ambulatory"),class:`\n                    touch-target p-4 border-2 rounded-xl text-center transition-all duration-200 font-medium\n                    ${"ambulatory"===v.mobility?"border-medical-success bg-green-50 text-green-700 shadow-sm":"border-gray-300 hover:border-gray-400 hover:bg-gray-50 active:bg-gray-100"}\n                  `,children:[i("div",{class:"text-2xl mb-1",children:"🚶"}),b("intake.mobility.ambulatory")]}),i("button",{type:"button",onClick:()=>M("mobility","non-ambulatory"),class:`\n                    touch-target p-4 border-2 rounded-xl text-center transition-all duration-200 font-medium\n                    ${"non-ambulatory"===v.mobility?"border-medical-warning bg-orange-50 text-orange-700 shadow-sm":"border-gray-300 hover:border-gray-400 hover:bg-gray-50 active:bg-gray-100"}\n                  `,children:[i("div",{class:"text-2xl mb-1",children:"🛏️"}),b("intake.mobility.immobile")]})]}),y.mobility&&i("p",{class:"text-medical-error text-sm mt-2 flex items-center gap-1",children:[i("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:i("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),y.mobility]})]})]})]}),i(c,{variant:"default",padding:"md",children:[i("h3",{class:"text-responsive-lg font-semibold text-medical-text-primary mb-4 flex items-center gap-2",children:[i("div",{class:"w-6 h-6 bg-medical-warning text-white rounded-full flex items-center justify-center text-sm font-bold",children:"4"}),b("intake.additional")]}),i("div",{class:"space-y-6",children:[i(o,{cols:{xs:1,md:2},gap:"md",children:[i("div",{children:[i("label",{class:"block text-sm font-medium text-medical-text-primary mb-2",children:b("intake.capillaryRefill")}),i("input",{type:"number",step:"0.1",value:v.capillaryRefill,onChange:e=>M("capillaryRefill",e.currentTarget.value),placeholder:b("intake.capillaryPlaceholder"),min:"0",max:"10",class:"form-input"}),y.capillaryRefill&&i("p",{class:"text-medical-error text-sm mt-1 flex items-center gap-1",children:[i("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:i("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),y.capillaryRefill]})]}),i("div",{children:[i("label",{class:"block text-sm font-medium text-medical-text-primary mb-2",children:b("intake.radialPulse")}),i("select",{value:v.radialPulse,onChange:e=>M("radialPulse",e.currentTarget.value),class:"form-select",children:[i("option",{value:"",children:b("validation.selectOption")}),i("option",{value:"present",children:["✅ ",b("intake.radialPulse.present")]}),i("option",{value:"absent",children:["❌ ",b("intake.radialPulse.absent")]})]})]})]}),i("div",{children:[i("label",{class:"block text-sm font-medium text-medical-text-primary mb-2",children:b("intake.injuries")}),i("textarea",{value:v.injuries,onChange:e=>M("injuries",e.currentTarget.value),placeholder:b("intake.injuriesPlaceholder"),rows:3,class:"form-textarea"}),i("p",{class:"text-xs text-medical-text-muted mt-1",children:b("intake.injuriesPlaceholder")})]}),i("div",{children:[i("label",{class:"block text-sm font-medium text-medical-text-primary mb-2",children:b("intake.notes")}),i("textarea",{value:v.notes,onChange:e=>M("notes",e.currentTarget.value),placeholder:b("intake.notesPlaceholder"),rows:3,class:"form-textarea"})]})]})]}),i(c,{variant:"default",padding:"md",className:"sticky bottom-4 safe-bottom",children:[i("div",{class:"flex flex-col sm:flex-row gap-3",children:[i(d,{type:"submit",variant:"primary",size:"lg",fullWidth:!0,disabled:k||!G(),loading:k,className:"sm:flex-1",children:b(x?"common.update":"common.save")}),i(d,{type:"button",variant:"outline",size:"lg",fullWidth:!0,onClick:()=>{g(m),f({}),C(null),j(!1),p&&p()},disabled:k,className:"sm:w-auto sm:px-8",children:b("common.cancel")})]}),!G()&&i("p",{class:"text-xs text-medical-text-muted mt-2 text-center",children:b("intake.completeRequired")})]})]})]})}export{u as PatientIntakeForm};
